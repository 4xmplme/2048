!function(){function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(e,r){if(e){if("string"==typeof e)return t(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,void 0)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}"use strict";"use strict";var r=new(function(){var t;function r(t){if(!(this instanceof r))throw TypeError("Cannot call a class as a function");this.score=0,this.status="idle",this.board=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]}return t=[{key:"_spawnNewTile",value:function(){for(var t=[],e=0;e<this.board.length;e++)for(var r=0;r<this.board[e].length;r++)0===this.board[e][r]&&t.push({rowIndex:e,colIndex:r});if(0!==t.length){var n=Math.floor(Math.random()*t.length),o=t[n],a=.1>Math.random()?4:2;this.board[o.rowIndex][o.colIndex]=a}}},{key:"_processRow",value:function(t){for(var e=t.filter(function(t){return 0!==t}),r=[],n=0;n<e.length;n++)if(n+1<e.length&&e[n]===e[n+1]){var o=2*e[n];2048===o&&(this.status="win"),r.push(o),this.score+=o,n++}else r.push(e[n]);for(;r.length<4;)r.push(0);return r}},{key:"_transposeBoard",value:function(){for(var t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],e=0;e<t.length;e++)for(var r=0;r<t[e].length;r++)t[r][e]=this.board[e][r];return t}},{key:"_checkForGameOver",value:function(){for(var t=0;t<4;t++)for(var e=0;e<4;e++)if(0===this.board[t][e]||t<3&&this.board[t][e]===this.board[t+1][e]||e<3&&this.board[t][e]===this.board[t][e+1])return;this.status="lose"}},{key:"move",value:function(t){var r=this;if("game over"===this.status)return!1;var n=JSON.stringify(this.board);switch(t){case"Up":this.board=this._transposeBoard(),this.board=this.board.map(function(t){return r._processRow(t)}),this.board=this._transposeBoard();break;case"Down":this.board=this._transposeBoard(),this.board=this.board.map(function(t){return r._processRow(e(t).reverse()).reverse()}),this.board=this._transposeBoard();break;case"Left":this.board=this.board.map(function(t){return r._processRow(t)});break;case"Right":this.board=this.board.map(function(t){return r._processRow(e(t).reverse()).reverse()})}var o=JSON.stringify(this.board)!==n;return o&&(this._spawnNewTile(),this._checkForGameOver()),o}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.board}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.restart()}},{key:"restart",value:function(){this.score=0,this.status="playing",this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this._spawnNewTile(),this._spawnNewTile()}}],function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(r.prototype,t),r}()),n=document.querySelector(".game-score"),o=document.querySelector(".button"),a=document.querySelector("tbody"),s=document.querySelector(".message-start"),i=document.querySelector(".message-win"),c=document.querySelector(".message-lose"),u=function(){var t=r.getState(),e=r.getScore(),o=a.querySelectorAll("tr");n.textContent=e,o.forEach(function(e,r){e.querySelectorAll("td").forEach(function(e,n){var o=t[r][n];e.textContent=0===o?"":o,e.className="field-cell field-cell--".concat(o)})})},l=function(){var t=r.getStatus();s.classList.toggle("hidden","idle"!==t),i.classList.toggle("hidden","win"!==t),c.classList.toggle("hidden","lose"!==t),"playing"===t&&(o.textContent="Restart",o.className="button restart")},h=function(t){"lose"!==r.getStatus()&&r.move(t)&&(u(),l())};o.addEventListener("click",function(){r.start(),u(),l()}),document.addEventListener("keydown",function(t){var e;switch(t.key){case"ArrowUp":e="Up";break;case"ArrowDown":e="Down";break;case"ArrowLeft":e="Left";break;case"ArrowRight":e="Right";break;default:return}t.preventDefault(),h(e)}),i.querySelector(".keep-playing").addEventListener("click",function(){r.continuePlaying(),i.classList.add("hidden")});var d=0,f=0,v=document.querySelector(".game-field");v.addEventListener("touchstart",function(t){t.preventDefault(),d=t.touches[0].clientX,f=t.touches[0].clientY},{passive:!1}),v.addEventListener("touchend",function(t){var e,r,n,o;t.preventDefault(),e=t.changedTouches[0].clientX,r=t.changedTouches[0].clientY,Math.abs(n=e-d)>Math.abs(o=r-f)?n>50?h("Right"):n<-50&&h("Left"):o>50?h("Down"):o<-50&&h("Up")})}();
//# sourceMappingURL=2048.f3775a44.js.map
